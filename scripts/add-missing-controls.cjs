#!/usr/bin/env node
/**
 * Script to add missing controls for framework coverage
 * Run with: node scripts/add-missing-controls.cjs
 */

const fs = require('fs');
const path = require('path');

const controlsPath = path.join(__dirname, '../src/constants/controls.ts');
let content = fs.readFileSync(controlsPath, 'utf8');

// New controls to add for missing framework requirements
const newControls = `
  // ============================================================================
  // PROCESSING INTEGRITY CONTROLS (SOC 2 PI1.1-PI1.5)
  // ============================================================================
  {
    id: 'PI-001',
    domain: 'data_protection',
    title: 'Data Input Accuracy',
    description: 'Ensure data inputs are complete, accurate, and authorized.',
    question: 'Are data inputs validated for completeness, accuracy, and proper authorization before processing?',
    guidance: 'Implement input validation. Verify data sources. Establish authorization controls for data entry.',
    evidenceExamples: [
      'Input validation rules',
      'Data source verification procedures',
      'Authorization matrices for data entry',
    ],
    remediationTip: 'Implement comprehensive input validation. Create data source verification procedures.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'PI1.1', clauseTitle: 'Obtains or Generates Accurate and Complete Data' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.3', clauseTitle: 'Information access restriction' },
      { frameworkId: 'NIST', clauseId: 'PR.DS-10', clauseTitle: 'Integrity of data-in-use is protected' },
    ],
    keywords: ['data input', 'validation', 'accuracy', 'completeness', 'authorization'],
  },
  {
    id: 'PI-002',
    domain: 'data_protection',
    title: 'Processing Accuracy',
    description: 'Ensure system processing is complete, accurate, and timely.',
    question: 'Are there controls to ensure system processing is complete, valid, accurate, and timely?',
    guidance: 'Implement processing controls. Monitor processing accuracy. Track processing timeliness.',
    evidenceExamples: [
      'Processing control documentation',
      'Accuracy monitoring reports',
      'Processing time metrics',
    ],
    remediationTip: 'Implement processing validation. Create accuracy monitoring dashboards.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'PI1.2', clauseTitle: 'Complete, Accurate, and Timely Processing' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.9', clauseTitle: 'Configuration management' },
      { frameworkId: 'NIST', clauseId: 'PR.DS-10', clauseTitle: 'Integrity of data-in-use is protected' },
    ],
    keywords: ['processing', 'accuracy', 'completeness', 'timeliness', 'validation'],
  },
  {
    id: 'PI-003',
    domain: 'data_protection',
    title: 'Output Completeness',
    description: 'Ensure system outputs are complete and accurate.',
    question: 'Are there controls to ensure system outputs are complete and accurate?',
    guidance: 'Implement output validation. Compare outputs to inputs. Perform reconciliation checks.',
    evidenceExamples: [
      'Output validation procedures',
      'Reconciliation reports',
      'Output accuracy metrics',
    ],
    remediationTip: 'Implement output validation controls. Create reconciliation procedures.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'PI1.3', clauseTitle: 'Outputs Complete and Accurate' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.11', clauseTitle: 'Data masking' },
      { frameworkId: 'NIST', clauseId: 'PR.DS-10', clauseTitle: 'Integrity of data-in-use is protected' },
    ],
    keywords: ['output', 'completeness', 'accuracy', 'reconciliation', 'validation'],
  },
  {
    id: 'PI-004',
    domain: 'data_protection',
    title: 'Processing Error Handling',
    description: 'Handle processing integrity errors and exceptions.',
    question: 'Are processing errors detected and corrected in a timely manner?',
    guidance: 'Implement error detection. Create correction procedures. Track error resolution.',
    evidenceExamples: [
      'Error handling procedures',
      'Error tracking logs',
      'Correction verification records',
    ],
    remediationTip: 'Implement error detection mechanisms. Create error correction workflows.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'PI1.4', clauseTitle: 'Processing Integrity Errors are Addressed' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.15', clauseTitle: 'Logging' },
      { frameworkId: 'NIST', clauseId: 'DE.AE-02', clauseTitle: 'Potentially adverse events are analyzed' },
    ],
    keywords: ['error handling', 'correction', 'processing errors', 'exception handling'],
  },
  {
    id: 'PI-005',
    domain: 'data_protection',
    title: 'Input Processing Controls',
    description: 'Controls for accurate input processing.',
    question: 'Is input processed accurately according to system specifications?',
    guidance: 'Document processing specifications. Validate against specifications. Monitor processing accuracy.',
    evidenceExamples: [
      'Processing specifications',
      'Validation test results',
      'Processing accuracy reports',
    ],
    remediationTip: 'Document and maintain processing specifications. Implement continuous validation.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'PI1.5', clauseTitle: 'Input is Processed Accurately' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.9', clauseTitle: 'Configuration management' },
      { frameworkId: 'NIST', clauseId: 'PR.DS-10', clauseTitle: 'Integrity of data-in-use is protected' },
    ],
    keywords: ['input processing', 'specifications', 'accuracy', 'validation'],
  },

  // ============================================================================
  // CONFIDENTIALITY CONTROLS (SOC 2 C1.1-C1.2)
  // ============================================================================
  {
    id: 'CF-001',
    domain: 'data_protection',
    title: 'Confidential Information Identification',
    description: 'Identify and maintain confidential information.',
    question: 'Is confidential information identified, classified, and protected throughout its lifecycle?',
    guidance: 'Define confidentiality criteria. Classify data. Implement protection controls based on classification.',
    evidenceExamples: [
      'Data classification policy',
      'Confidential data inventory',
      'Protection control matrix',
    ],
    remediationTip: 'Create data classification scheme. Identify all confidential information.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'C1.1', clauseTitle: 'Identifies and Maintains Confidential Information' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.12', clauseTitle: 'Classification of information' },
      { frameworkId: 'NIST', clauseId: 'ID.AM-05', clauseTitle: 'Assets are prioritized based on classification' },
      { frameworkId: 'GDPR', clauseId: 'Art.30', clauseTitle: 'Records of processing activities' },
    ],
    keywords: ['confidentiality', 'classification', 'identification', 'data protection'],
  },
  {
    id: 'CF-002',
    domain: 'data_protection',
    title: 'Confidential Information Disposal',
    description: 'Securely dispose of confidential information.',
    question: 'Is confidential information securely disposed of when no longer needed?',
    guidance: 'Define retention periods. Implement secure disposal. Verify disposal completeness.',
    evidenceExamples: [
      'Data retention policy',
      'Secure disposal procedures',
      'Disposal certificates',
    ],
    remediationTip: 'Implement secure disposal procedures. Document all disposals.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'C1.2', clauseTitle: 'Disposes of Confidential Information' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.10', clauseTitle: 'Information deletion' },
      { frameworkId: 'NIST', clauseId: 'PR.DS-11', clauseTitle: 'Backups are created, protected, maintained, and tested' },
      { frameworkId: 'GDPR', clauseId: 'Art.17', clauseTitle: 'Right to erasure' },
      { frameworkId: 'PCIDSS', clauseId: '3.2', clauseTitle: 'Storage of account data is kept to a minimum' },
    ],
    keywords: ['disposal', 'destruction', 'retention', 'confidential data'],
  },

  // ============================================================================
  // GOVERNANCE CONTROLS (NIST CSF 2.0 GOVERN Function)
  // ============================================================================
  {
    id: 'GV-001',
    domain: 'compliance_monitoring',
    title: 'Organizational Mission Alignment',
    description: 'Organizational mission informs cybersecurity risk management.',
    question: 'Does the organizational mission inform and guide cybersecurity risk management decisions?',
    guidance: 'Document mission alignment. Integrate security into business objectives. Review alignment regularly.',
    evidenceExamples: [
      'Mission-security alignment documentation',
      'Strategic security objectives',
      'Board-level security discussions',
    ],
    remediationTip: 'Document how security supports organizational mission. Present to leadership.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OC-01', clauseTitle: 'Organizational mission is understood and informs cybersecurity risk management' },
      { frameworkId: 'SOC2', clauseId: 'CC1.1', clauseTitle: 'Demonstrates Commitment to Integrity and Ethical Values' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['mission', 'alignment', 'governance', 'strategy', 'objectives'],
  },
  {
    id: 'GV-002',
    domain: 'compliance_monitoring',
    title: 'Stakeholder Understanding',
    description: 'Internal and external stakeholders are understood.',
    question: 'Are internal and external stakeholders and their cybersecurity expectations understood?',
    guidance: 'Identify stakeholders. Document expectations. Establish communication channels.',
    evidenceExamples: [
      'Stakeholder register',
      'Communication plan',
      'Expectation documentation',
    ],
    remediationTip: 'Create stakeholder map. Document security expectations for each group.',
    riskLevel: 'low',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OC-02', clauseTitle: 'Internal and external stakeholders are understood' },
      { frameworkId: 'SOC2', clauseId: 'CC2.3', clauseTitle: 'Communicates Externally' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.6', clauseTitle: 'Contact with special interest groups' },
    ],
    keywords: ['stakeholders', 'communication', 'expectations', 'internal', 'external'],
  },
  {
    id: 'GV-003',
    domain: 'compliance_monitoring',
    title: 'Legal and Regulatory Requirements',
    description: 'Legal, regulatory, and contractual requirements are understood.',
    question: 'Are legal, regulatory, and contractual cybersecurity requirements identified and understood?',
    guidance: 'Identify applicable requirements. Track changes. Ensure compliance.',
    evidenceExamples: [
      'Regulatory requirements register',
      'Compliance tracking matrix',
      'Legal counsel opinions',
    ],
    remediationTip: 'Create regulatory requirements inventory. Assign compliance owners.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OC-03', clauseTitle: 'Legal, regulatory, and contractual requirements are understood' },
      { frameworkId: 'SOC2', clauseId: 'CC3.1', clauseTitle: 'Specifies Suitable Objectives' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.31', clauseTitle: 'Legal, statutory, regulatory and contractual requirements' },
      { frameworkId: 'GDPR', clauseId: 'Art.5(2)', clauseTitle: 'Accountability' },
    ],
    keywords: ['legal', 'regulatory', 'compliance', 'contractual', 'requirements'],
  },
  {
    id: 'GV-004',
    domain: 'compliance_monitoring',
    title: 'Critical Objectives Understanding',
    description: 'Critical objectives, capabilities, and services are understood.',
    question: 'Are critical business objectives, capabilities, and services that depend on cybersecurity understood?',
    guidance: 'Identify critical functions. Map security dependencies. Prioritize protection.',
    evidenceExamples: [
      'Critical asset inventory',
      'Dependency mapping',
      'Priority classification',
    ],
    remediationTip: 'Conduct business impact analysis. Identify critical security dependencies.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OC-04', clauseTitle: 'Critical objectives, capabilities, and services are understood' },
      { frameworkId: 'SOC2', clauseId: 'A1.1', clauseTitle: 'Maintains, Monitors, and Evaluates Current Processing Capacity' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.30', clauseTitle: 'ICT readiness for business continuity' },
    ],
    keywords: ['critical', 'objectives', 'capabilities', 'services', 'dependencies'],
  },
  {
    id: 'GV-005',
    domain: 'compliance_monitoring',
    title: 'Dependency Management',
    description: 'Outcomes, capabilities, and services dependencies are understood.',
    question: 'Are dependencies between outcomes, capabilities, and services understood and documented?',
    guidance: 'Map dependencies. Analyze impact chains. Document relationships.',
    evidenceExamples: [
      'Dependency diagrams',
      'Impact analysis documentation',
      'Service relationship maps',
    ],
    remediationTip: 'Create comprehensive dependency maps. Update regularly.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OC-05', clauseTitle: 'Outcomes, capabilities, and services dependencies are understood' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.21', clauseTitle: 'Managing information security in the ICT supply chain' },
    ],
    keywords: ['dependencies', 'mapping', 'relationships', 'impact analysis'],
  },
  {
    id: 'GV-006',
    domain: 'risk_assessment',
    title: 'Risk Management Objectives',
    description: 'Risk management objectives are established and agreed upon.',
    question: 'Are cybersecurity risk management objectives established and agreed upon by leadership?',
    guidance: 'Define risk objectives. Obtain leadership approval. Communicate objectives.',
    evidenceExamples: [
      'Risk management objectives document',
      'Leadership approval records',
      'Communication evidence',
    ],
    remediationTip: 'Draft risk objectives. Present to leadership for approval.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-01', clauseTitle: 'Risk management objectives are established and agreed upon' },
      { frameworkId: 'SOC2', clauseId: 'CC3.1', clauseTitle: 'Specifies Suitable Objectives' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['risk objectives', 'leadership', 'approval', 'governance'],
  },
  {
    id: 'GV-007',
    domain: 'risk_assessment',
    title: 'Risk Appetite and Tolerance',
    description: 'Risk appetite and tolerance statements are established.',
    question: 'Are organizational risk appetite and risk tolerance statements documented and approved?',
    guidance: 'Define risk appetite. Set tolerance thresholds. Obtain board approval.',
    evidenceExamples: [
      'Risk appetite statement',
      'Risk tolerance thresholds',
      'Board approval documentation',
    ],
    remediationTip: 'Develop risk appetite statement. Define quantitative tolerance levels.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-02', clauseTitle: 'Risk appetite and risk tolerance statements are established' },
      { frameworkId: 'SOC2', clauseId: 'CC3.2', clauseTitle: 'Identifies and Analyzes Risk' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['risk appetite', 'tolerance', 'thresholds', 'governance'],
  },
  {
    id: 'GV-008',
    domain: 'risk_assessment',
    title: 'Enterprise Risk Integration',
    description: 'Cybersecurity risk is integrated into enterprise risk management.',
    question: 'Is cybersecurity risk management integrated into enterprise risk management processes?',
    guidance: 'Align with ERM. Report through ERM channels. Use consistent metrics.',
    evidenceExamples: [
      'ERM integration documentation',
      'Combined risk reports',
      'Unified risk metrics',
    ],
    remediationTip: 'Map cyber risks to ERM framework. Create unified reporting.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-03', clauseTitle: 'Cybersecurity risk management activities and outcomes are included in enterprise risk management' },
      { frameworkId: 'SOC2', clauseId: 'CC3.2', clauseTitle: 'Identifies and Analyzes Risk' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['ERM', 'enterprise risk', 'integration', 'alignment'],
  },
  {
    id: 'GV-009',
    domain: 'risk_assessment',
    title: 'Risk Response Options',
    description: 'Strategic direction describes appropriate risk response options.',
    question: 'Does strategic direction include guidance on appropriate risk response options?',
    guidance: 'Define response options (accept, mitigate, transfer, avoid). Establish criteria for selection.',
    evidenceExamples: [
      'Risk response framework',
      'Decision criteria documentation',
      'Response option guidelines',
    ],
    remediationTip: 'Document risk response options. Create selection criteria.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-04', clauseTitle: 'Strategic direction describes appropriate risk response options' },
      { frameworkId: 'SOC2', clauseId: 'CC3.2', clauseTitle: 'Identifies and Analyzes Risk' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['risk response', 'mitigation', 'acceptance', 'transfer', 'avoidance'],
  },
  {
    id: 'GV-010',
    domain: 'compliance_monitoring',
    title: 'Risk Communication Lines',
    description: 'Lines of communication across the organization are established.',
    question: 'Are clear lines of communication for cybersecurity risk established across the organization?',
    guidance: 'Define reporting lines. Establish escalation paths. Create communication protocols.',
    evidenceExamples: [
      'Communication matrix',
      'Escalation procedures',
      'Reporting schedules',
    ],
    remediationTip: 'Create cybersecurity communication plan. Define escalation paths.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-05', clauseTitle: 'Lines of communication across the organization are established' },
      { frameworkId: 'SOC2', clauseId: 'CC2.1', clauseTitle: 'Uses Relevant Information' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.5', clauseTitle: 'Contact with authorities' },
    ],
    keywords: ['communication', 'reporting', 'escalation', 'governance'],
  },
  {
    id: 'GV-011',
    domain: 'risk_assessment',
    title: 'Risk Calculation Method',
    description: 'Standardized method for calculating and prioritizing risks.',
    question: 'Is there a standardized method for calculating, documenting, categorizing, and prioritizing cybersecurity risks?',
    guidance: 'Define risk calculation methodology. Create risk categorization scheme. Establish prioritization criteria.',
    evidenceExamples: [
      'Risk calculation methodology',
      'Risk categorization framework',
      'Prioritization matrix',
    ],
    remediationTip: 'Adopt risk calculation methodology (FAIR, etc.). Document and train staff.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RM-06', clauseTitle: 'A standardized method for calculating, documenting, categorizing, and prioritizing cybersecurity risks is established' },
      { frameworkId: 'SOC2', clauseId: 'CC3.2', clauseTitle: 'Identifies and Analyzes Risk' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
    ],
    keywords: ['risk calculation', 'methodology', 'prioritization', 'FAIR'],
  },
  {
    id: 'GV-012',
    domain: 'compliance_monitoring',
    title: 'Security Leadership Responsibility',
    description: 'Organizational leadership is responsible for cybersecurity risk.',
    question: 'Is organizational leadership clearly responsible and accountable for cybersecurity risk?',
    guidance: 'Assign leadership responsibility. Document accountability. Report to board.',
    evidenceExamples: [
      'Leadership responsibility matrix',
      'Board reporting documentation',
      'Accountability assignments',
    ],
    remediationTip: 'Assign CISO or equivalent. Establish board reporting cadence.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RR-01', clauseTitle: 'Organizational leadership is responsible for cybersecurity risk' },
      { frameworkId: 'SOC2', clauseId: 'CC1.2', clauseTitle: 'Board of Directors Demonstrates Independence' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.2', clauseTitle: 'Information security roles and responsibilities' },
    ],
    keywords: ['leadership', 'responsibility', 'accountability', 'CISO', 'board'],
  },
  {
    id: 'GV-013',
    domain: 'compliance_monitoring',
    title: 'Roles and Responsibilities',
    description: 'Cybersecurity roles, responsibilities, and authorities are established.',
    question: 'Are cybersecurity roles, responsibilities, and authorities clearly established and communicated?',
    guidance: 'Define roles clearly. Document responsibilities. Communicate to all parties.',
    evidenceExamples: [
      'RACI matrix',
      'Job descriptions',
      'Organizational charts',
    ],
    remediationTip: 'Create security RACI matrix. Include in job descriptions.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RR-02', clauseTitle: 'Roles, responsibilities, and authorities are established and communicated' },
      { frameworkId: 'SOC2', clauseId: 'CC1.3', clauseTitle: 'Management Establishes Structures and Reporting Lines' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.2', clauseTitle: 'Information security roles and responsibilities' },
      { frameworkId: 'HIPAA', clauseId: '164.308(a)(2)', clauseTitle: 'Assigned Security Responsibility' },
    ],
    keywords: ['roles', 'responsibilities', 'RACI', 'accountability'],
  },
  {
    id: 'GV-014',
    domain: 'compliance_monitoring',
    title: 'Resource Allocation',
    description: 'Adequate resources are allocated commensurate with risk strategy.',
    question: 'Are adequate resources (budget, personnel, technology) allocated for cybersecurity commensurate with risk?',
    guidance: 'Assess resource needs. Justify budget requests. Track resource adequacy.',
    evidenceExamples: [
      'Security budget documentation',
      'Staffing plans',
      'Resource adequacy assessments',
    ],
    remediationTip: 'Conduct resource gap analysis. Present business case for resources.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RR-03', clauseTitle: 'Adequate resources are allocated commensurate with risk strategy' },
      { frameworkId: 'SOC2', clauseId: 'CC1.4', clauseTitle: 'Commitment to Competence' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.2', clauseTitle: 'Information security roles and responsibilities' },
    ],
    keywords: ['resources', 'budget', 'staffing', 'allocation'],
  },
  {
    id: 'GV-015',
    domain: 'hr_security',
    title: 'HR Security Practices',
    description: 'Cybersecurity is included in human resources practices.',
    question: 'Is cybersecurity included in HR practices (hiring, onboarding, performance, termination)?',
    guidance: 'Include security in hiring. Train on onboarding. Include in performance reviews.',
    evidenceExamples: [
      'Security in hiring procedures',
      'Onboarding security training',
      'Security performance criteria',
    ],
    remediationTip: 'Update HR procedures to include security. Create security performance criteria.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.RR-04', clauseTitle: 'Cybersecurity is included in human resources practices' },
      { frameworkId: 'SOC2', clauseId: 'CC1.4', clauseTitle: 'Commitment to Competence' },
      { frameworkId: 'ISO27001', clauseId: 'A.6.1', clauseTitle: 'Screening' },
      { frameworkId: 'HIPAA', clauseId: '164.308(a)(3)', clauseTitle: 'Workforce Security' },
    ],
    keywords: ['HR', 'hiring', 'onboarding', 'termination', 'performance'],
  },
  {
    id: 'GV-016',
    domain: 'compliance_monitoring',
    title: 'Security Policy Establishment',
    description: 'Policy for cybersecurity risk management is established.',
    question: 'Is a comprehensive policy for cybersecurity risk management established and approved?',
    guidance: 'Develop security policy. Obtain executive approval. Distribute organization-wide.',
    evidenceExamples: [
      'Information security policy',
      'Executive approval',
      'Distribution records',
    ],
    remediationTip: 'Develop comprehensive security policy. Obtain board approval.',
    riskLevel: 'critical',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.PO-01', clauseTitle: 'Policy for cybersecurity risk management is established' },
      { frameworkId: 'SOC2', clauseId: 'CC5.3', clauseTitle: 'Deploys through Policies and Procedures' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
      { frameworkId: 'HIPAA', clauseId: '164.316(a)', clauseTitle: 'Policies and Procedures' },
      { frameworkId: 'PCIDSS', clauseId: '12.1', clauseTitle: 'A comprehensive information security policy is known' },
    ],
    keywords: ['policy', 'security policy', 'governance', 'approval'],
  },
  {
    id: 'GV-017',
    domain: 'compliance_monitoring',
    title: 'Policy Review and Update',
    description: 'Policy is reviewed, updated, communicated, and enforced.',
    question: 'Is security policy regularly reviewed, updated, communicated, and enforced?',
    guidance: 'Review annually. Update as needed. Communicate changes. Enforce compliance.',
    evidenceExamples: [
      'Policy review records',
      'Change communication evidence',
      'Enforcement records',
    ],
    remediationTip: 'Establish annual policy review. Document and communicate changes.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.PO-02', clauseTitle: 'Policy is reviewed, updated, communicated, and enforced' },
      { frameworkId: 'SOC2', clauseId: 'CC5.3', clauseTitle: 'Deploys through Policies and Procedures' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
      { frameworkId: 'HIPAA', clauseId: '164.316(b)(2)(iii)', clauseTitle: 'Updates' },
    ],
    keywords: ['policy review', 'update', 'communication', 'enforcement'],
  },
  {
    id: 'GV-018',
    domain: 'compliance_monitoring',
    title: 'Strategy Outcome Review',
    description: 'Cybersecurity risk management strategy outcomes are reviewed.',
    question: 'Are cybersecurity risk management strategy outcomes regularly reviewed?',
    guidance: 'Establish review cadence. Assess effectiveness. Report to leadership.',
    evidenceExamples: [
      'Strategy review reports',
      'Effectiveness assessments',
      'Leadership presentations',
    ],
    remediationTip: 'Establish quarterly strategy reviews. Create metrics dashboard.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OV-01', clauseTitle: 'Cybersecurity risk management strategy outcomes are reviewed' },
      { frameworkId: 'SOC2', clauseId: 'CC4.1', clauseTitle: 'Selects and Develops Ongoing/Separate Evaluations' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.35', clauseTitle: 'Independent review of information security' },
    ],
    keywords: ['strategy review', 'outcomes', 'effectiveness', 'governance'],
  },
  {
    id: 'GV-019',
    domain: 'compliance_monitoring',
    title: 'Strategy Adjustment',
    description: 'Security strategy is adjusted based on reviews.',
    question: 'Is the cybersecurity risk management strategy adjusted based on review outcomes?',
    guidance: 'Act on review findings. Update strategy. Document changes.',
    evidenceExamples: [
      'Strategy adjustment documentation',
      'Change implementation records',
      'Updated strategy documents',
    ],
    remediationTip: 'Create process for strategy adjustments. Track implementation.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OV-02', clauseTitle: 'The cybersecurity risk management strategy is adjusted based on reviews' },
      { frameworkId: 'SOC2', clauseId: 'CC4.2', clauseTitle: 'Evaluates and Communicates Deficiencies' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.36', clauseTitle: 'Compliance with policies, rules and standards' },
    ],
    keywords: ['strategy adjustment', 'improvement', 'adaptation'],
  },
  {
    id: 'GV-020',
    domain: 'compliance_monitoring',
    title: 'Performance Evaluation',
    description: 'Organizational cybersecurity risk management performance is evaluated.',
    question: 'Is organizational cybersecurity risk management performance evaluated against objectives?',
    guidance: 'Define metrics. Measure performance. Compare to objectives.',
    evidenceExamples: [
      'Performance metrics',
      'KPI dashboards',
      'Objective achievement reports',
    ],
    remediationTip: 'Define security KPIs. Create performance dashboards.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.OV-03', clauseTitle: 'Organizational cybersecurity risk management performance is evaluated' },
      { frameworkId: 'SOC2', clauseId: 'CC4.1', clauseTitle: 'Selects and Develops Ongoing/Separate Evaluations' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.35', clauseTitle: 'Independent review of information security' },
    ],
    keywords: ['performance', 'evaluation', 'metrics', 'KPIs'],
  },

  // ============================================================================
  // SUPPLY CHAIN RISK MANAGEMENT (NIST CSF 2.0 GV.SC)
  // ============================================================================
  {
    id: 'GV-021',
    domain: 'vendor_management',
    title: 'Supply Chain Risk Program',
    description: 'Cybersecurity supply chain risk management program is established.',
    question: 'Is a formal cybersecurity supply chain risk management program established?',
    guidance: 'Define SCRM program. Document processes. Assign ownership.',
    evidenceExamples: [
      'SCRM program documentation',
      'Process documentation',
      'Program ownership assignment',
    ],
    remediationTip: 'Establish formal supply chain security program. Document and communicate.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-01', clauseTitle: 'Cybersecurity supply chain risk management program is established' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.19', clauseTitle: 'Information security in supplier relationships' },
      { frameworkId: 'PCIDSS', clauseId: '12.8', clauseTitle: 'Risk to information assets associated with TPSPs is managed' },
    ],
    keywords: ['supply chain', 'SCRM', 'vendor risk', 'third party'],
  },
  {
    id: 'GV-022',
    domain: 'vendor_management',
    title: 'Supplier Security Roles',
    description: 'Cybersecurity roles and responsibilities for suppliers are established.',
    question: 'Are cybersecurity roles and responsibilities for suppliers and partners clearly established?',
    guidance: 'Define supplier security requirements. Include in contracts. Monitor compliance.',
    evidenceExamples: [
      'Supplier security requirements',
      'Contract security clauses',
      'Compliance monitoring records',
    ],
    remediationTip: 'Add security requirements to supplier contracts. Define responsibilities.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-02', clauseTitle: 'Cybersecurity roles and responsibilities for suppliers are established' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.20', clauseTitle: 'Addressing information security within supplier agreements' },
      { frameworkId: 'GDPR', clauseId: 'Art.28(3)', clauseTitle: 'Processing contract requirements' },
    ],
    keywords: ['supplier roles', 'responsibilities', 'contracts', 'third party'],
  },
  {
    id: 'GV-023',
    domain: 'vendor_management',
    title: 'SCRM Integration',
    description: 'Supply chain risk management is integrated into security programs.',
    question: 'Is cybersecurity supply chain risk management integrated into overall security programs?',
    guidance: 'Integrate SCRM with security operations. Include in risk assessments.',
    evidenceExamples: [
      'Integration documentation',
      'Combined risk assessments',
      'Unified processes',
    ],
    remediationTip: 'Integrate supply chain risks into overall risk program.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-03', clauseTitle: 'Cybersecurity supply chain risk management is integrated' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.21', clauseTitle: 'Managing information security in the ICT supply chain' },
    ],
    keywords: ['SCRM integration', 'security program', 'unified'],
  },
  {
    id: 'GV-024',
    domain: 'vendor_management',
    title: 'Supplier Prioritization',
    description: 'Suppliers are known and prioritized by criticality.',
    question: 'Are suppliers known, inventoried, and prioritized by criticality to the organization?',
    guidance: 'Inventory all suppliers. Assess criticality. Prioritize risk management efforts.',
    evidenceExamples: [
      'Supplier inventory',
      'Criticality assessments',
      'Tiered supplier classification',
    ],
    remediationTip: 'Create comprehensive supplier inventory. Implement tiering system.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-04', clauseTitle: 'Suppliers are known and prioritized by criticality' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.19', clauseTitle: 'Information security in supplier relationships' },
      { frameworkId: 'PCIDSS', clauseId: '12.8.1', clauseTitle: 'Service provider list' },
    ],
    keywords: ['supplier inventory', 'criticality', 'prioritization', 'tiering'],
  },
  {
    id: 'GV-025',
    domain: 'vendor_management',
    title: 'Contract Security Requirements',
    description: 'Security requirements are included in supplier contracts.',
    question: 'Are cybersecurity requirements included in contracts with all suppliers and partners?',
    guidance: 'Include security clauses. Define compliance expectations. Require incident reporting.',
    evidenceExamples: [
      'Contract templates with security clauses',
      'Executed contracts',
      'Security addenda',
    ],
    remediationTip: 'Develop standard security contract language. Apply to all agreements.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-05', clauseTitle: 'Requirements are included in contracts with suppliers' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.20', clauseTitle: 'Addressing information security within supplier agreements' },
      { frameworkId: 'GDPR', clauseId: 'Art.28(3)', clauseTitle: 'Processing contract requirements' },
      { frameworkId: 'HIPAA', clauseId: '164.308(b)(1)', clauseTitle: 'Written Contract or Other Arrangement' },
    ],
    keywords: ['contracts', 'security requirements', 'agreements', 'clauses'],
  },
  {
    id: 'GV-026',
    domain: 'vendor_management',
    title: 'Supplier Due Diligence',
    description: 'Planning and due diligence are conducted with suppliers.',
    question: 'Is security due diligence conducted before engaging suppliers and periodically thereafter?',
    guidance: 'Conduct pre-engagement assessment. Review periodically. Document findings.',
    evidenceExamples: [
      'Due diligence questionnaires',
      'Security assessments',
      'Periodic review records',
    ],
    remediationTip: 'Develop due diligence process. Conduct initial and periodic reviews.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-06', clauseTitle: 'Planning and due diligence are conducted with suppliers' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.22', clauseTitle: 'Monitoring, review and change management of supplier services' },
      { frameworkId: 'PCIDSS', clauseId: '12.8.4', clauseTitle: 'Service provider monitoring' },
    ],
    keywords: ['due diligence', 'assessment', 'vendor review', 'evaluation'],
  },
  {
    id: 'GV-027',
    domain: 'vendor_management',
    title: 'Supplier Risk Management',
    description: 'Risks posed by suppliers are understood and managed.',
    question: 'Are risks posed by suppliers understood, documented, and actively managed?',
    guidance: 'Assess supplier risks. Document risk levels. Implement risk treatments.',
    evidenceExamples: [
      'Supplier risk assessments',
      'Risk treatment plans',
      'Risk monitoring records',
    ],
    remediationTip: 'Conduct supplier risk assessments. Create treatment plans for high risks.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-07', clauseTitle: 'Risks posed by a supplier are understood and managed' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.22', clauseTitle: 'Monitoring, review and change management of supplier services' },
    ],
    keywords: ['supplier risk', 'risk management', 'treatment', 'monitoring'],
  },
  {
    id: 'GV-028',
    domain: 'vendor_management',
    title: 'Supplier Incident Planning',
    description: 'Relevant suppliers are included in incident planning.',
    question: 'Are critical suppliers included in incident response and business continuity planning?',
    guidance: 'Include suppliers in IR plans. Define communication protocols. Test with suppliers.',
    evidenceExamples: [
      'Supplier IR communication plans',
      'Joint exercises',
      'Contact matrices',
    ],
    remediationTip: 'Add suppliers to incident response plans. Conduct joint exercises.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-08', clauseTitle: 'Relevant suppliers are included in incident planning' },
      { frameworkId: 'SOC2', clauseId: 'CC7.4', clauseTitle: 'Security Incident Response' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.24', clauseTitle: 'Information security incident management planning and preparation' },
    ],
    keywords: ['supplier incidents', 'incident planning', 'communication', 'coordination'],
  },
  {
    id: 'GV-029',
    domain: 'vendor_management',
    title: 'Supply Chain Security Integration',
    description: 'Supply chain security practices are integrated into programs.',
    question: 'Are supply chain security practices integrated into organizational security programs?',
    guidance: 'Embed SCRM in security processes. Include in training. Monitor continuously.',
    evidenceExamples: [
      'Integrated procedures',
      'Training materials',
      'Monitoring dashboards',
    ],
    remediationTip: 'Embed supply chain security into standard procedures.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-09', clauseTitle: 'Supply chain security practices are integrated into programs' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.21', clauseTitle: 'Managing information security in the ICT supply chain' },
    ],
    keywords: ['supply chain integration', 'security practices', 'embedding'],
  },
  {
    id: 'GV-030',
    domain: 'vendor_management',
    title: 'Supplier Offboarding',
    description: 'SCRM plans include provisions for offboarding suppliers.',
    question: 'Do supply chain risk management plans include provisions for offboarding suppliers?',
    guidance: 'Define offboarding procedures. Ensure data return/destruction. Revoke access.',
    evidenceExamples: [
      'Offboarding procedures',
      'Data return/destruction records',
      'Access revocation evidence',
    ],
    remediationTip: 'Create supplier offboarding checklist. Include data handling requirements.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'NIST', clauseId: 'GV.SC-10', clauseTitle: 'Cybersecurity supply chain risk management plans include provisions for offboarding' },
      { frameworkId: 'SOC2', clauseId: 'CC9.2', clauseTitle: 'Vendor and Business Partner Risk Mitigation' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.20', clauseTitle: 'Addressing information security within supplier agreements' },
      { frameworkId: 'GDPR', clauseId: 'Art.28(3)(g)', clauseTitle: 'Delete or return data after processing ends' },
    ],
    keywords: ['offboarding', 'supplier exit', 'data return', 'access revocation'],
  },

  // ============================================================================
  // GDPR DATA SUBJECT RIGHTS CONTROLS
  // ============================================================================
  {
    id: 'DSR-001',
    domain: 'data_protection',
    title: 'Right of Access',
    description: 'Handle data subject access requests.',
    question: 'Is there a process to handle data subject access requests within required timeframes?',
    guidance: 'Establish DSAR process. Define response timeframes. Track requests.',
    evidenceExamples: [
      'DSAR procedure',
      'Request tracking system',
      'Response templates',
    ],
    remediationTip: 'Implement DSAR handling process. Create response templates.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.15', clauseTitle: 'Right of access by the data subject' },
      { frameworkId: 'SOC2', clauseId: 'P5.1', clauseTitle: 'Provides Access to Personal Information for Review' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['DSAR', 'access request', 'data subject rights', 'GDPR'],
  },
  {
    id: 'DSR-002',
    domain: 'data_protection',
    title: 'Right to Rectification',
    description: 'Allow correction of inaccurate personal data.',
    question: 'Is there a process for data subjects to request rectification of inaccurate personal data?',
    guidance: 'Enable data correction. Verify identity. Update all systems.',
    evidenceExamples: [
      'Rectification procedure',
      'Identity verification process',
      'Update records',
    ],
    remediationTip: 'Create rectification request process. Ensure propagation to all systems.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.16', clauseTitle: 'Right to rectification' },
      { frameworkId: 'SOC2', clauseId: 'P5.2', clauseTitle: 'Correction, Amendment, or Appendment of Personal Information' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['rectification', 'correction', 'data accuracy', 'GDPR'],
  },
  {
    id: 'DSR-003',
    domain: 'data_protection',
    title: 'Right to Restriction',
    description: 'Handle requests to restrict processing.',
    question: 'Is there a process to handle requests to restrict processing of personal data?',
    guidance: 'Define restriction procedures. Implement technical controls. Track restrictions.',
    evidenceExamples: [
      'Restriction procedure',
      'Technical implementation',
      'Restriction tracking',
    ],
    remediationTip: 'Create restriction handling process. Implement technical flags.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.18', clauseTitle: 'Right to restriction of processing' },
      { frameworkId: 'SOC2', clauseId: 'P2.1', clauseTitle: 'Communicates Choices for Data Collection, Use, and Retention' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['restriction', 'processing limitation', 'data subject rights', 'GDPR'],
  },
  {
    id: 'DSR-004',
    domain: 'data_protection',
    title: 'Right to Data Portability',
    description: 'Provide data in portable format.',
    question: 'Is there a process to provide personal data in a structured, commonly used, machine-readable format?',
    guidance: 'Define export formats. Implement export capability. Enable transmission to other controllers.',
    evidenceExamples: [
      'Data export procedures',
      'Export format documentation',
      'Transmission records',
    ],
    remediationTip: 'Implement data export in JSON/CSV format. Create portability request process.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.20', clauseTitle: 'Right to data portability' },
      { frameworkId: 'SOC2', clauseId: 'P5.1', clauseTitle: 'Provides Access to Personal Information for Review' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['portability', 'data export', 'machine-readable', 'GDPR'],
  },
  {
    id: 'DSR-005',
    domain: 'data_protection',
    title: 'Lawfulness of Processing',
    description: 'Ensure lawful basis for all processing.',
    question: 'Is there a documented lawful basis for all personal data processing activities?',
    guidance: 'Identify lawful basis. Document in records. Review regularly.',
    evidenceExamples: [
      'Lawful basis documentation',
      'Processing records',
      'Legal review records',
    ],
    remediationTip: 'Document lawful basis for each processing activity. Include in ROPA.',
    riskLevel: 'critical',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.6(1)', clauseTitle: 'Lawfulness of processing' },
      { frameworkId: 'SOC2', clauseId: 'P1.1', clauseTitle: 'Provides Notice About Privacy Practices' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['lawful basis', 'legal grounds', 'processing', 'GDPR'],
  },
  {
    id: 'DSR-006',
    domain: 'data_protection',
    title: 'Consent Management',
    description: 'Manage consent for data processing.',
    question: 'Is consent obtained, managed, and documented according to GDPR requirements?',
    guidance: 'Implement consent mechanism. Track consent. Enable withdrawal.',
    evidenceExamples: [
      'Consent forms',
      'Consent management system',
      'Withdrawal process',
    ],
    remediationTip: 'Implement consent management platform. Track all consent records.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'GDPR', clauseId: 'Art.7', clauseTitle: 'Conditions for consent' },
      { frameworkId: 'SOC2', clauseId: 'P2.1', clauseTitle: 'Communicates Choices for Data Collection, Use, and Retention' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.34', clauseTitle: 'Privacy and protection of PII' },
    ],
    keywords: ['consent', 'opt-in', 'withdrawal', 'GDPR'],
  },

  // ============================================================================
  // MISSING SOC 2 CONTROLS
  // ============================================================================
  {
    id: 'SOC-001',
    domain: 'compliance_monitoring',
    title: 'Board Independence',
    description: 'Board of Directors demonstrates independence from management.',
    question: 'Does the Board of Directors demonstrate independence from management in oversight of internal control?',
    guidance: 'Maintain independent board members. Separate oversight functions. Document independence.',
    evidenceExamples: [
      'Board composition documentation',
      'Independence certifications',
      'Oversight meeting minutes',
    ],
    remediationTip: 'Ensure board independence. Document oversight activities.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC1.2', clauseTitle: 'Board of Directors Demonstrates Independence' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
      { frameworkId: 'NIST', clauseId: 'GV.RR-01', clauseTitle: 'Organizational leadership is responsible' },
    ],
    keywords: ['board', 'independence', 'oversight', 'governance'],
  },
  {
    id: 'SOC-002',
    domain: 'compliance_monitoring',
    title: 'Management Structures',
    description: 'Management establishes structures, reporting lines, and authorities.',
    question: 'Has management established structures, reporting lines, and appropriate authorities and responsibilities?',
    guidance: 'Define organizational structure. Establish reporting lines. Assign authorities.',
    evidenceExamples: [
      'Organizational charts',
      'Reporting structure documentation',
      'Authority matrices',
    ],
    remediationTip: 'Document organizational structure. Define clear reporting lines.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC1.3', clauseTitle: 'Management Establishes Structures and Reporting Lines' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.2', clauseTitle: 'Information security roles and responsibilities' },
      { frameworkId: 'NIST', clauseId: 'GV.RR-02', clauseTitle: 'Roles, responsibilities, and authorities are established' },
    ],
    keywords: ['structure', 'reporting', 'authorities', 'organization'],
  },
  {
    id: 'SOC-003',
    domain: 'compliance_monitoring',
    title: 'Accountability Enforcement',
    description: 'Organization enforces accountability for internal control responsibilities.',
    question: 'Does the organization enforce accountability for internal control responsibilities?',
    guidance: 'Define accountability. Implement enforcement mechanisms. Track compliance.',
    evidenceExamples: [
      'Accountability policies',
      'Enforcement actions',
      'Performance evaluations',
    ],
    remediationTip: 'Create accountability framework. Include in performance evaluations.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC1.5', clauseTitle: 'Enforces Accountability' },
      { frameworkId: 'ISO27001', clauseId: 'A.6.4', clauseTitle: 'Disciplinary process' },
      { frameworkId: 'NIST', clauseId: 'GV.RR-01', clauseTitle: 'Organizational leadership is responsible' },
    ],
    keywords: ['accountability', 'enforcement', 'responsibility', 'governance'],
  },
  {
    id: 'SOC-004',
    domain: 'compliance_monitoring',
    title: 'Internal Communication',
    description: 'Organization communicates internally including objectives and responsibilities.',
    question: 'Does the organization communicate internally about internal control matters including objectives?',
    guidance: 'Establish communication channels. Share objectives. Report on control matters.',
    evidenceExamples: [
      'Internal communications',
      'Objective documentation',
      'Control reporting',
    ],
    remediationTip: 'Create internal communication plan for security matters.',
    riskLevel: 'low',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC2.2', clauseTitle: 'Communicates Internally' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.4', clauseTitle: 'Management responsibilities' },
      { frameworkId: 'NIST', clauseId: 'GV.RM-05', clauseTitle: 'Lines of communication are established' },
    ],
    keywords: ['internal communication', 'objectives', 'reporting'],
  },
  {
    id: 'SOC-005',
    domain: 'risk_assessment',
    title: 'Fraud Risk Assessment',
    description: 'Organization assesses fraud risk.',
    question: 'Does the organization consider the potential for fraud in assessing risks?',
    guidance: 'Assess fraud risk. Identify fraud scenarios. Implement anti-fraud controls.',
    evidenceExamples: [
      'Fraud risk assessment',
      'Anti-fraud controls',
      'Fraud scenarios',
    ],
    remediationTip: 'Conduct fraud risk assessment. Implement anti-fraud controls.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC3.3', clauseTitle: 'Assesses Fraud Risk' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.7', clauseTitle: 'Threat intelligence' },
      { frameworkId: 'NIST', clauseId: 'ID.RA-03', clauseTitle: 'Internal and external threats are identified' },
    ],
    keywords: ['fraud', 'risk assessment', 'anti-fraud', 'threats'],
  },
  {
    id: 'SOC-006',
    domain: 'risk_assessment',
    title: 'Significant Change Analysis',
    description: 'Organization identifies and analyzes significant changes.',
    question: 'Does the organization identify and assess changes that could significantly impact internal control?',
    guidance: 'Identify significant changes. Assess impact. Update controls as needed.',
    evidenceExamples: [
      'Change impact assessments',
      'Significant change register',
      'Control updates',
    ],
    remediationTip: 'Create significant change assessment process.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC3.4', clauseTitle: 'Identifies and Analyzes Significant Change' },
      { frameworkId: 'ISO27001', clauseId: 'A.8.32', clauseTitle: 'Change management' },
      { frameworkId: 'NIST', clauseId: 'ID.RA-07', clauseTitle: 'Changes and exceptions are managed' },
    ],
    keywords: ['change analysis', 'significant change', 'impact assessment'],
  },
  {
    id: 'SOC-007',
    domain: 'compliance_monitoring',
    title: 'Control Activity Selection',
    description: 'Organization selects and develops control activities.',
    question: 'Does the organization select and develop control activities that mitigate risks?',
    guidance: 'Select appropriate controls. Develop control activities. Map to risks.',
    evidenceExamples: [
      'Control selection documentation',
      'Risk-control mapping',
      'Control development records',
    ],
    remediationTip: 'Document control selection rationale. Map controls to risks.',
    riskLevel: 'medium',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC5.1', clauseTitle: 'Selects and Develops Control Activities' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.1', clauseTitle: 'Policies for information security' },
      { frameworkId: 'NIST', clauseId: 'ID.RA-06', clauseTitle: 'Risk responses are chosen, prioritized, planned' },
    ],
    keywords: ['control activities', 'selection', 'development', 'risk mitigation'],
  },
  {
    id: 'SOC-008',
    domain: 'business_continuity',
    title: 'Business Disruption Risk',
    description: 'Organization identifies and mitigates business disruption risks.',
    question: 'Are risks from potential business disruptions identified, assessed, and mitigated?',
    guidance: 'Identify disruption risks. Develop mitigation strategies. Test regularly.',
    evidenceExamples: [
      'BIA documentation',
      'Mitigation strategies',
      'Testing records',
    ],
    remediationTip: 'Conduct BIA. Develop and test mitigation strategies.',
    riskLevel: 'high',
    frameworkMappings: [
      { frameworkId: 'SOC2', clauseId: 'CC9.1', clauseTitle: 'Business Disruption Risks Are Identified and Mitigated' },
      { frameworkId: 'ISO27001', clauseId: 'A.5.29', clauseTitle: 'Information security during disruption' },
      { frameworkId: 'NIST', clauseId: 'PR.IR-03', clauseTitle: 'Mechanisms are implemented to achieve resilience' },
    ],
    keywords: ['business disruption', 'BIA', 'resilience', 'mitigation'],
  },
`;

// Find the position to insert (before the closing bracket of MASTER_CONTROLS)
const insertPoint = content.lastIndexOf('];');
if (insertPoint === -1) {
  console.error('Could not find MASTER_CONTROLS closing bracket');
  process.exit(1);
}

// Insert the new controls
const newContent = content.substring(0, insertPoint) + newControls + content.substring(insertPoint);

// Update the header comment
const updatedContent = newContent.replace(
  'Master control library with 236 controls mapped to 6 compliance frameworks',
  'Master control library with 280+ controls mapped to 6 compliance frameworks'
);

// Write the file
fs.writeFileSync(controlsPath, updatedContent, 'utf8');

console.log('Successfully added new controls!');
console.log('New controls added:');
console.log('- Processing Integrity (PI-001 to PI-005): 5 controls');
console.log('- Confidentiality (CF-001 to CF-002): 2 controls');
console.log('- Governance (GV-001 to GV-030): 30 controls');
console.log('- Data Subject Rights (DSR-001 to DSR-006): 6 controls');
console.log('- SOC 2 Missing (SOC-001 to SOC-008): 8 controls');
console.log('Total new controls: 51');
